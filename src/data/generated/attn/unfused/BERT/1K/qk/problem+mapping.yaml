constraints:
  targets:
  - factors: [B=64, H=12]
    permutation: [E, M, P, H, B]
    target: DRAM
    type: temporal
  - bypass: []
    keep: [Q, K, QK]
    target: DRAM
    type: dataspace
  - factors: [B=1, H=1]
    permutation: [B, H]
    target: L3
    type: temporal
  - factors: [B=1, E=1, H=1, M=1, P=1]
    permutation: [E, P, M, H, B]
    target: reg_file_1d
    type: temporal
  - bypass: [Q, K, QK]
    keep: []
    target: reg_file_1d
    type: dataspace
  - factors: [B=1, E=1, H=1, M=1, P=256]
    permutation: [E, M, P, H, B]
    split: 5
    target: PE_col
    type: spatial
  - factors: [B=1, E=1, H=1, M=256, P=1]
    permutation: [E, M, P, H, B]
    split: 0
    target: PE
    type: spatial
  - factors: [B=1, E=1, H=1, M=1, P=1]
    permutation: [E, M, P, H, B]
    target: reg_file
    type: temporal
  - bypass: []
    keep: [Q, K, QK]
    target: reg_file
    type: dataspace
  version: 0.4
problem:
  instance: {B: 64, E: 64, H: 12, M: 1024, P: 1024}
  shape:
    data_spaces:
    - name: Q
      projection:
      - - [B]
      - - [E]
      - - [H]
      - - [P]
    - name: K
      projection:
      - - [B]
      - - [E]
      - - [H]
      - - [M]
    - name: QK
      projection:
      - - [B]
      - - [H]
      - - [M]
      - - [P]
      read_write: true
    dimensions: [B, E, H, M, P]
    name: QK
  version: '0.4'
